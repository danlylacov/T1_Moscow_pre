test:
  stage: test
  image: python:${PYTHON_VERSION:-3.11}
  cache:
    key: ${CI_COMMIT_REF_SLUG}-python
    paths:
      - .pip-cache
  dependencies: []
  before_script:
    - pip install --cache-dir .pip-cache -r requirements.txt
    - pip install pytest pytest-cov
  script:
    - pytest tests/ -v --cov=. --cov-report=xml
  artifacts:
    reports:
      coverage_report:
        coverage_format: cobertura
        path: coverage.xml
    expire_in: 1 week


